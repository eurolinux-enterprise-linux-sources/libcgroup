From 76dea5847ce8e3986a30b927a2b5cfdb232e9e63 Mon Sep 17 00:00:00 2001
From: Jan Chaloupka <jchaloup@redhat.com>
Date: Tue, 6 Jan 2015 15:18:42 +0100
Subject: [PATCH] extending cgroup names with default

---
 src/lex.l   |  2 +-
 src/parse.y | 14 ++++++++++++--
 2 files changed, 13 insertions(+), 3 deletions(-)

diff --git a/src/lex.l b/src/lex.l
index c1014c5..eacfe57 100644
--- a/src/lex.l
+++ b/src/lex.l
@@ -40,7 +40,7 @@ jmp_buf parser_error_env;
 "group"		{return GROUP;}
 "namespace"	{return NAMESPACE;}
 "template"	{return TEMPLATE;}
-"default"	{return DEFAULT;}
+"default"	{yylval.name = strdup(yytext); return DEFAULT;}
 [a-zA-Z0-9_\-\/\.\,\%]+ {yylval.name = strdup(yytext); return ID;}
 \"[^"]*\" {yylval.name = strdup(yytext+1); yylval.name[strlen(yylval.name)-1] = '\0'; return ID; }
 .	{return yytext[0];}
diff --git a/src/parse.y b/src/parse.y
index f51332c..2d75d3d 100644
--- a/src/parse.y
+++ b/src/parse.y
@@ -45,7 +45,7 @@ int yywrap(void)
 	int val;
 	struct cgroup_dictionary *values;
 }
-%type <name> ID
+%type <name> ID DEFAULT group_name
 %type <val> mountvalue_conf mount task_namevalue_conf admin_namevalue_conf
 %type <val> admin_conf task_conf task_or_admin group_conf group start
 %type <val> namespace namespace_conf default default_conf
@@ -98,7 +98,7 @@ default_conf
 	}
 	;
 
-group   :       GROUP ID '{' group_conf '}'
+group   :       GROUP group_name '{' group_conf '}'
 	{
 		$$ = $4;
 		if ($$) {
@@ -118,6 +118,16 @@ group   :       GROUP ID '{' group_conf '}'
 	}
         ;
 
+group_name
+       :       ID
+       {
+               $$ = $1;
+       }
+       |       DEFAULT
+       {
+               $$ = $1;
+       }
+
 group_conf
         :       ID '{' namevalue_conf '}'
 	{
-- 
1.9.3

